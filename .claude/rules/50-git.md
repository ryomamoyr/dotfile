---
paths: "**/*"
---
# Git運用ルール

## 基本方針
- 既にブランチが切られている前提で、可能な範囲で変更を反映し、pushまで行う
- ただし、破壊的操作や履歴改変（rebase / reset --hard / force push）はデフォルトで行わない

## 禁止操作（明示的な許可がない限り実行禁止）
- `git push --force` / `git push -f`: 履歴の強制上書き
- `git reset --hard`: コミット履歴の破棄
- `git rebase`: 履歴の書き換え
- `git commit --amend` + push済みコミット: リモート履歴の改変
- `git clean -fd`: 未追跡ファイルの強制削除
- `git checkout -- .` / `git restore .`: 全変更の破棄（個別ファイル指定は可）
- ブランチの削除（`git branch -D`）: 特にリモートブランチ

## 許可が必要な場合の対応
- 上記操作が必要な場合は、実行前に「何を」「なぜ」「影響範囲」を提示し、許可を求める
- 許可なく実行した場合、復旧困難な状態になる可能性があることを認識する

## 実行の流れ（原則）
- 変更内容を確認：`git status` / `git diff`
- 必要最小限のファイルだけをステージ：`git add -p`（部分的に分ける価値がない場合は `git add <paths>`）
- コミット：日本語で簡潔に1行（必要なら2行目以降に補足）
- push：`git push -u origin HEAD`（初回のみ upstream 設定）

## コミットメッセージ規約（日本語）
- 1行目：変更の要点を簡潔に（体言止め or 「〜する」）
- 例：
  - `可視化の軸ラベルを日本語に統一`
  - `uv sync を実行する手順を追記`
  - `Polars集計のdtype不整合を修正`
- 細かい雑多な変更を1コミットに詰めない。意味のある単位で分ける

## 追加ルール
- 変更が大きい場合は、コミット前に要約（何が変わるか・影響範囲）を短く示す
- テスト/検証コマンドがある場合は、コミット前に実行する（例：`uv run pytest` 等）
- 競合解消や履歴整理が必要な場合は、勝手に履歴改変せず方針を提示する
